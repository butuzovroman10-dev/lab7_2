#include "multiplication_algorithms.h"
#include "utils.h"
#include <iostream>
#include <iomanip>
#include <vector>

using namespace std;

void displayMenu() {
    cout << "=========================================\n";
    cout << "     –£–ú–ù–û–ñ–ï–ù–ò–ï –ë–û–õ–¨–®–ò–• –ß–ò–°–ï–õ\n";
    cout << "=========================================\n";
    cout << "1. üß™ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤\n";
    cout << "2. üìä –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏\n";
    cout << "3. üîß –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n";
    cout << "4. üéØ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤\n";
    cout << "5. üìà –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\n";
    cout << "0. ‚ùå –í—ã—Ö–æ–¥\n";
    cout << "=========================================\n";
    cout << "–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é: ";
}

void demonstrateAlgorithms() {
    cout << "\nüéØ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –†–ê–ë–û–¢–´ –ê–õ–ì–û–†–ò–¢–ú–û–í\n";
    cout << "=========================================\n";
    
    string num1 = "12345678901234567890";
    string num2 = "98765432109876543210";
    
    cout << "–ß–∏—Å–ª–æ 1: " << num1 << endl;
    cout << "–ß–∏—Å–ª–æ 2: " << num2 << endl;
    cout << endl;
    
    cout << "–ù–∞–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º O(n¬≤):" << endl;
    string naive_result = naiveMultiply(num1, num2);
    cout << "–†–µ–∑—É–ª—å—Ç–∞—Ç: " << naive_result.substr(0, 50) << "..." << endl;
    
    cout << "\n–ê–ª–≥–æ—Ä–∏—Ç–º –ö–∞—Ä–∞—Ü—É–±—ã O(n^log‚ÇÇ3):" << endl;
    string karatsuba_result = karatsubaMultiply(num1, num2);
    cout << "–†–µ–∑—É–ª—å—Ç–∞—Ç: " << karatsuba_result.substr(0, 50) << "..." << endl;
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    string r1 = naive_result;
    string r2 = karatsuba_result;
    removeLeadingZeros(r1);
    removeLeadingZeros(r2);
    bool results_match = (r1 == r2);
    
    cout << "\n‚úì –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç: " 
         << (results_match ? "–î–ê" : "–ù–ï–¢") 
         << endl;
}

void showTheoreticalAnalysis() {
    cout << "\nüìä –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó\n";
    cout << "=========================================\n";
    cout << "–°–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:\n\n";
    
    cout << "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n";
    cout << "‚îÇ   –ê–ª–≥–æ—Ä–∏—Ç–º      ‚îÇ   –°–ª–æ–∂–Ω–æ—Å—Ç—å (Big O)   ‚îÇ      –û–ø–∏—Å–∞–Ω–∏–µ              ‚îÇ\n";
    cout << "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n";
    cout << "‚îÇ –ù–∞–∏–≤–Ω—ã–π         ‚îÇ O(n¬≤)                 ‚îÇ –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å     ‚îÇ\n";
    cout << "‚îÇ –ö–∞—Ä–∞—Ü—É–±—ã        ‚îÇ O(n^log‚ÇÇ3) ‚âà O(n¬π.‚Åµ‚Å∏) ‚îÇ –°—É–±–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å  ‚îÇ\n";
    cout << "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n";
    
    cout << "\n–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è:\n";
    cout << "‚Ä¢ –ú–∞–ª—ã–µ —á–∏—Å–ª–∞ (< 100 —Ü–∏—Ñ—Ä): –ù–∞–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–µ—Ç –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ\n";
    cout << "‚Ä¢ –°—Ä–µ–¥–Ω–∏–µ —á–∏—Å–ª–∞ (100-1000 —Ü–∏—Ñ—Ä): –ö–∞—Ä–∞—Ü—É–±—ã –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–∏–≥—Ä—ã–≤–∞—Ç—å\n";
    cout << "‚Ä¢ –ë–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞ (> 1000 —Ü–∏—Ñ—Ä): –ö–∞—Ä–∞—Ü—É–±—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ\n";
}

void runComparativeTest() {
    cout << "\nüß™ –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï\n";
    cout << "=========================================\n";
    
    cout << "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:\n";
    cout << "1. –ú–∞–ª—ã–µ (100 —Ü–∏—Ñ—Ä)\n";
    cout << "2. –°—Ä–µ–¥–Ω–∏–µ (1000 —Ü–∏—Ñ—Ä)\n";
    cout << "3. –ë–æ–ª—å—à–∏–µ (10000 —Ü–∏—Ñ—Ä)\n";
    cout << "–í–∞—à –≤—ã–±–æ—Ä: ";
    
    int choice;
    cin >> choice;
    
    if (choice < 1 || choice > 3) {
        cout << "–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!" << endl;
        return;
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —á–∏—Å–ª–∞ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞–ø—Ä—è–º—É—é
    int size;
    switch(choice) {
        case 1: size = 100; break;
        case 2: size = 1000; break;
        case 3: size = 10000; break;
        default: size = 100;
    }
    
    string num1 = TestGenerator::generateRandomNumber(size);
    string num2 = TestGenerator::generateRandomNumber(size);
    
    cout << "\n–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —á–∏—Å–ª–∞—Ö –¥–ª–∏–Ω–æ–π " << num1.length() << " —Ü–∏—Ñ—Ä...\n";
    
    auto results = PerformanceTester::runComparativeTest(num1, num2);
    
    cout << "\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n";
    cout << "‚îÇ   –ê–ª–≥–æ—Ä–∏—Ç–º      ‚îÇ   –í—Ä–µ–º—è    ‚îÇ  –°–ª–æ–∂–Ω–æ—Å—Ç—å   ‚îÇ     –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å     ‚îÇ\n";
    cout << "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n";
    
    for (const auto& result : results) {
        cout << "‚îÇ " << setw(15) << left << result.algorithm << " ‚îÇ "
             << setw(10) << fixed << setprecision(2) << result.execution_time << " –º—Å ‚îÇ "
             << setw(12) << (result.algorithm.find("Naive") != string::npos ? "O(n¬≤)" : "O(n^log‚ÇÇ3)") << " ‚îÇ "
             << setw(20) << (result.correct ? "‚úì –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ" : "‚úó –û—à–∏–±–∫–∞") << " ‚îÇ\n";
    }
    
    cout << "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n";
}

int main() {
    // –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    createDirectory("data");
    createDirectory("data/test_cases");
    createDirectory("data/test_cases/small");
    createDirectory("data/test_cases/medium");
    createDirectory("data/test_cases/large");
    createDirectory("data/results");
    createDirectory("docs");
    
    int choice;
    
    do {
        displayMenu();
        cin >> choice;
        
        switch (choice) {
            case 1:
                runComparativeTest();
                break;
            case 2:
                cout << "\n–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏...\n";
                PerformanceTester::generatePerformanceReport(5000);
                cout << "‚úì –û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –≤ docs/report.html\n";
                break;
            case 3:
                cout << "\n–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...\n";
                TestGenerator::generateTestCases();
                break;
            case 4:
                demonstrateAlgorithms();
                break;
            case 5:
                showTheoreticalAnalysis();
                break;
            case 0:
                cout << "\n–î–æ —Å–≤–∏–¥–∞–Ω–∏—è!\n";
                break;
            default:
                cout << "\n–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\n";
        }
        
        if (choice != 0) {
            cout << "\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";
            cin.ignore();
            cin.get();
        }
        
    } while (choice != 0);
    
    return 0;
}